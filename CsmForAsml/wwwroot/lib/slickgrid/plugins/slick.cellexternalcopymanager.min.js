/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/slickgrid@2.4.27/plugins/slick.cellexternalcopymanager.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e){e.extend(!0,window,{Slick:{CellExternalCopyManager:function(t){var l,o,n=this,a=t||{},r=a.copiedCellStyleLayerKey||"copy-manager",i=a.copiedCellStyle||"copied",s=0,u=a.bodyElement||document.body,c=a.onCopyInit||null,d=a.onCopySuccess||null,f={C:67,V:86,ESC:27,INSERT:45};function h(e){if(a.headerColumnValueExtractor){var t=a.headerColumnValueExtractor(e);if(t)return t}return e.name}function C(t,o,n){if(a.dataItemColumnValueExtractor){var r=a.dataItemColumnValueExtractor(t,o);if(r)return r}var i="";if(o.editor){var s={container:e("<p>"),column:o,position:{top:0,left:0},grid:l,event:n},u=new o.editor(s);u.loadValue(t),i=u.serializeValue(),u.destroy()}else i=t[o.field];return i}function m(t,o,n){if(o.denyPaste)return null;if(a.dataItemColumnValueSetter)return a.dataItemColumnValueSetter(t,o,n);if(o.editor){var r={container:e("body"),column:o,position:{top:0,left:0},grid:l},i=new o.editor(r);i.loadValue(t),i.applyValue(t,n),i.destroy()}else t[o.field]=n}function g(e){var t=document.createElement("textarea");return t.style.position="absolute",t.style.left="-1000px",t.style.top=document.body.scrollTop+"px",t.value=e,u.appendChild(t),t.select(),t}function p(e,t){var r;if(!l.getEditorLock().isActive()||l.getOptions().autoEdit){if(e.which==f.ESC&&o&&(e.preventDefault(),v(),n.onCopyCancelled.notify({ranges:o}),o=null),(e.which===f.C||e.which===f.INSERT)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(c&&c.call(),0!==(r=l.getSelectionModel().getSelectedRanges()).length)){o=r,y(r),n.onCopyCells.notify({ranges:r});for(var i=l.getColumns(),s="",p=0;p<r.length;p++){for(var w=r[p],S=[],D=w.fromRow;D<w.toRow+1;D++){var R=[],x=l.getDataItem(D);if(0===S.length&&a.includeHeaderWhenCopying){for(var E=[],V=w.fromCell;V<w.toCell+1;V++)i[V].name.length>0&&E.push(h(i[V]));S.push(E.join("\t"))}for(var V=w.fromCell;V<w.toCell+1;V++)R.push(C(x,i[V],e));S.push(R.join("\t"))}s+=S.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",s),!0;var b=document.activeElement,I=g(s);if(I.focus(),setTimeout(function(){u.removeChild(I),b?b.focus():console.log("Not element to restore focus to after copy?")},100),d){var M=0;M=1===r.length?r[0].toRow+1-r[0].fromRow:r.length,d.call(this,M)}return!1}if(!a.readOnlyMode&&(e.which===f.V&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.which===f.INSERT&&e.shiftKey&&!e.ctrlKey)){var I=g("");return setTimeout(function(){!function(e,t){var l=e.getColumns(),o=t.value.split(/[\n\f\r]/);""===o[o.length-1]&&o.pop();var r=[],i=0;u.removeChild(t);for(var s=0;s<o.length;s++)""!==o[s]?r[i++]=o[s].split("\t"):r[i++]=[""];var c=e.getActiveCell(),d=e.getSelectionModel().getSelectedRanges(),f=d&&d.length?d[0]:null,h=null,C=null;if(f)h=f.fromRow,C=f.fromCell;else{if(!c)return;h=c.row,C=c.cell}var g=!1,p=r.length,v=r.length?r[0].length:0;1==r.length&&1==r[0].length&&f&&(g=!0,p=f.toRow-f.fromRow+1,v=f.toCell-f.fromCell+1);var w=e.getData().length-h,S=0;if(w<p&&a.newRowCreator){var D=e.getData();for(S=1;S<=p-w;S++)D.push({});e.setData(D),e.render()}var R=h+p>e.getDataLength();if(a.newRowCreator&&R){var x=h+p-e.getDataLength();a.newRowCreator(x)}var E={isClipboardCommand:!0,clippedRange:r,oldValues:[],cellExternalCopyManager:n,_options:a,setDataItemValueForColumn:m,markCopySelection:y,oneCellToMultiple:g,activeRow:h,activeCell:C,destH:p,destW:v,maxDestY:e.getDataLength(),maxDestX:e.getColumns().length,h:0,w:0,execute:function(){this.h=0;for(var t=0;t<this.destH;t++){this.oldValues[t]=[],this.w=0,this.h++;for(var o=0;o<this.destW;o++){this.w++;var n=h+t,a=C+o;if(n<this.maxDestY&&a<this.maxDestX){e.getCellNode(n,a);var i=e.getDataItem(n);this.oldValues[t][o]=i[l[a].field],g?this.setDataItemValueForColumn(i,l[a],r[0][0]):this.setDataItemValueForColumn(i,l[a],r[t]?r[t][o]:""),e.updateCell(n,a),e.onCellChange.notify({row:n,cell:a,item:i,grid:e})}}}var s={fromCell:C,fromRow:h,toCell:C+this.w-1,toRow:h+this.h-1};this.markCopySelection([s]),e.getSelectionModel().setSelectedRanges([s]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[s]})},undo:function(){for(var t=0;t<this.destH;t++)for(var o=0;o<this.destW;o++){var n=h+t,a=C+o;if(n<this.maxDestY&&a<this.maxDestX){e.getCellNode(n,a);var r=e.getDataItem(n);g?this.setDataItemValueForColumn(r,l[a],this.oldValues[0][0]):this.setDataItemValueForColumn(r,l[a],this.oldValues[t][o]),e.updateCell(n,a),e.onCellChange.notify({row:n,cell:a,item:r,grid:e})}}var i={fromCell:C,fromRow:h,toCell:C+this.w-1,toRow:h+this.h-1};if(this.markCopySelection([i]),e.getSelectionModel().setSelectedRanges([i]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[i]}),S>1){for(var s=e.getData();S>1;S--)s.splice(s.length-1,1);e.setData(s),e.render()}}};a.clipboardCommandHandler?a.clipboardCommandHandler(E):E.execute()}(l,I)},100),!1}}}function y(e){v();for(var t=l.getColumns(),o={},a=0;a<e.length;a++)for(var u=e[a].fromRow;u<=e[a].toRow;u++){o[u]={};for(var c=e[a].fromCell;c<=e[a].toCell&&c<t.length;c++)o[u][t[c].id]=i}l.setCellCssStyles(r,o),clearTimeout(s),s=setTimeout(function(){n.clearCopySelection()},2e3)}function v(){l.removeCellCssStyles(r)}e.extend(this,{init:function(e){(l=e).onKeyDown.subscribe(p);var t=e.getSelectionModel();if(!t)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new Slick.CellSelectionModel())");t.onSelectedRangesChanged.subscribe(function(e,t){l.focus()})},destroy:function(){l.onKeyDown.unsubscribe(p)},pluginName:"CellExternalCopyManager",clearCopySelection:v,handleKeyDown:p,onCopyCells:new Slick.Event,onCopyCancelled:new Slick.Event,onPasteCells:new Slick.Event,setIncludeHeaderWhenCopying:function(e){a.includeHeaderWhenCopying=e}})}}})}(jQuery);
//# sourceMappingURL=/sm/d4586fc682e1052444ab38c17143e5e80dcd7d16c7bf6db7a6be1db1bbcb068d.map